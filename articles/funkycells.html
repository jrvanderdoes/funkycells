<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="funkycells">
<title>funkycells • funkycells</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="funkycells">
<meta property="og:description" content="funkycells">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">funkycells</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9004</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/funkycells.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/TNBC.html">TNBC</a>
    <a class="dropdown-item" href="../articles/model_walkthrough.html">model_walkthrough</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jrvanderdoes/funkycells/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>funkycells</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jrvanderdoes/funkycells/blob/HEAD/vignettes/funkycells.Rmd" class="external-link"><code>vignettes/funkycells.Rmd</code></a></small>
      <div class="d-none name"><code>funkycells.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrvanderdoes/funkycells" class="external-link">funkycells</a></span><span class="op">)</span></span></code></pre></div>
<p>This documents a sample view of <code>funkycells</code>. Every
function will be examined throughout this vignette, feel free to see the
process from beginning to end or jumping to a given step in the
document. Although each step in the <code>funkycells</code> process is
addressed, detailed information on each function is left to their
respective documentation.</p>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>This package is interested in investigating spatial data. Although
potentially combined, in the most raw form the data of interest would be
(1) cell information (locations, patient, image, etc.) and (2) meta-data
(patient demographics, etc.).</p>
<p>Rather than loading in data, we will generate data with such
properties. The cell data is constructed using
<code><a href="../reference/simulatePP.html">simulatePP()</a></code>, as given below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">cell_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulatePP.html">simulatePP</a></span><span class="op">(</span></span>
<span>  cellVarData <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      <span class="st">"stage"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      <span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>      <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">100</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">500</span><span class="op">)</span>,</span>
<span>      <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">500</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">250</span><span class="op">)</span>,</span>
<span>      <span class="st">"D"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">100</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>  cellKappaData <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      <span class="st">"cell"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span>,</span>
<span>      <span class="st">"clusterCell"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"A"</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="st">"kappa"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">5</span>, <span class="fl">15</span>, <span class="fl">15</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>  peoplePerStage <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  imagesPerPerson <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Stage: 0 (1/2)</span></span>
<span><span class="co">#&gt; Stage: 1 (2/2)</span></span></code></pre></div>
<p>We look at some pictures using <code><a href="../reference/plotPP.html">plotPP()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPP.html">plotPP</a></span><span class="op">(</span><span class="va">cell_data</span><span class="op">[</span><span class="va">cell_data</span><span class="op">$</span><span class="va">Image</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"cellType"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  dropAxes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  colorGuide <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="funkycells_files/figure-html/plot_data-1.png" width="700"></p>
<p>In funkycells we often explain the cell interactions using <span class="math inline">\(K\)</span> functions, although many functions are
feasible. For example, K functions could be computed as the following
function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getKFunction.html">getKFunction</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cell_data</span><span class="op">[</span><span class="va">cell_data</span><span class="op">$</span><span class="va">Person</span> <span class="op">==</span> <span class="st">"p1"</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  agents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span><span class="op">)</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"Person"</span>,</span>
<span>  repeatedUniqueId <span class="op">=</span> <span class="st">"Image"</span>,</span>
<span>  rCheckVals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  xRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  yRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>However, <code><a href="../reference/funkyModel.html">funkyModel()</a></code> does not use functions directly,
but the principle components of functions. Because of the commonness of
<span class="math inline">\(K\)</span> functions, currently we
implemented the steps in the same function<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This may be changed soon&lt;/p&gt;"><sup>1</sup></a>. Although in our data,
the cellTypes are in a single column, the functions accepts when the
cell properties are defined in many columns (see documentation on
<code><a href="../reference/getKsPCAData.html">getKsPCAData()</a></code>). We also note that we only consider
one-direction of the interactions to reduce variables and improve model
power.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cell_data</span><span class="op">$</span><span class="va">cellType</span><span class="op">)</span></span>
<span><span class="va">cells_interactions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="va">cells</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"X1"</span> <span class="op">=</span> <span class="va">cells</span>, <span class="st">"X2"</span> <span class="op">=</span> <span class="va">cells</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pca_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getKsPCAData.html">getKsPCAData</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cell_data</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"Stage"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"Person"</span>,</span>
<span>  repeatedUniqueId <span class="op">=</span> <span class="st">"Image"</span>,</span>
<span>  rCheckVals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  agents_df <span class="op">=</span> <span class="va">cells_interactions</span>,</span>
<span>  xRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, yRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  nPCs <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; PCA Pairs (10): 1, 2, 3, 4, 5, 6, 7, 8, 9, 10</span></span></code></pre></div>
<p>Upon this data, we attach the meta information. For example, to this
data we will add gender (with no effect), and age (with some
effect).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">pcaMeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateMeta.html">simulateMeta</a></span><span class="op">(</span><span class="va">pca_data</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"Stage"</span>,</span>
<span>  metaInfo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    <span class="st">"var"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"age"</span><span class="op">)</span>,</span>
<span>    <span class="st">"rdist"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rbinom"</span>, <span class="st">"rnorm"</span><span class="op">)</span>,</span>
<span>    <span class="st">"Stage_0"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.5"</span>, <span class="st">"30"</span><span class="op">)</span>,</span>
<span>    <span class="st">"Stage_1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.5"</span>, <span class="st">"31"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h2>
<p>We now jump into the model. We use <code><a href="../reference/funkyModel.html">funkyModel()</a></code> as it
employs cross-validation and permutation to create accurate models.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">model_fc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/funkyModel.html">funkyModel</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pcaMeta</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"Stage"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"Person"</span>,</span>
<span>  metaNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The variable importance plot is returned (plot not shown as this was
not run for computational reasons).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_fc</span><span class="op">$</span><span class="va">viPlot</span></span></code></pre></div>
<p>The results of the model from <code><a href="../reference/funkyModel.html">funkyModel()</a></code> also includes
the model from <code><a href="../reference/funkyForest.html">funkyForest()</a></code> on the original data, which is
necessary when trying to predict new data. Suppose we create a few new
people (i.e. get more data) and wish to predict. This would be done as
follows.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">cell_data_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulatePP.html">simulatePP</a></span><span class="op">(</span></span>
<span>  cellVarData <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      <span class="st">"stage"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      <span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>      <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">100</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">500</span><span class="op">)</span>,</span>
<span>      <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">500</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">250</span><span class="op">)</span>,</span>
<span>      <span class="st">"D"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">100</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>  cellKappaData <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      <span class="st">"cell"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span>,</span>
<span>      <span class="st">"clusterCell"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"A"</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="st">"kappa"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">5</span>, <span class="fl">15</span>, <span class="fl">15</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>  peoplePerStage <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  imagesPerPerson <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pca_data_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getKsPCAData.html">getKsPCAData</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cell_data_pred</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"Stage"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"Person"</span>,</span>
<span>  repeatedUniqueId <span class="op">=</span> <span class="st">"Image"</span>,</span>
<span>  rCheckVals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  agents_df <span class="op">=</span> <span class="va">cells_interactions</span>,</span>
<span>  xRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, yRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  nPCs <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">pcaMeta_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateMeta.html">simulateMeta</a></span><span class="op">(</span><span class="va">pca_data_pred</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"Stage"</span>,</span>
<span>  metaInfo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    <span class="st">"var"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"age"</span><span class="op">)</span>,</span>
<span>    <span class="st">"rdist"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rbinom"</span>, <span class="st">"rnorm"</span><span class="op">)</span>,</span>
<span>    <span class="st">"Stage_0"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.5"</span>, <span class="st">"30"</span><span class="op">)</span>,</span>
<span>    <span class="st">"Stage_1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.5"</span>, <span class="st">"31"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_funkyForest.html">predict_funkyForest</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_fc</span><span class="op">$</span><span class="va">model</span>, data_pred <span class="op">=</span> <span class="va">pcaMeta_pred</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="other-investigations">Other Investigations<a class="anchor" aria-label="anchor" href="#other-investigations"></a>
</h2>
<p>We also can compare K functions by group.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ab_stage0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getKFunction.html">getKFunction</a></span><span class="op">(</span><span class="va">cell_data</span><span class="op">[</span><span class="va">cell_data</span><span class="op">$</span><span class="va">Stage</span> <span class="op">==</span> <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  agents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, unit <span class="op">=</span> <span class="st">"Person"</span>,</span>
<span>  repeatedUniqueId <span class="op">=</span> <span class="st">"Image"</span>,</span>
<span>  rCheckVals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ab_stage1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getKFunction.html">getKFunction</a></span><span class="op">(</span><span class="va">cell_data</span><span class="op">[</span><span class="va">cell_data</span><span class="op">$</span><span class="va">Stage</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  agents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, unit <span class="op">=</span> <span class="st">"Person"</span>,</span>
<span>  repeatedUniqueId <span class="op">=</span> <span class="st">"Image"</span>,</span>
<span>  rCheckVals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ab_stage0_long</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ab_stage0</span>, cols <span class="op">=</span> <span class="va">K1</span><span class="op">:</span><span class="va">K15</span><span class="op">)</span></span>
<span><span class="va">ab_stage1_long</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ab_stage1</span>, cols <span class="op">=</span> <span class="va">K1</span><span class="op">:</span><span class="va">K15</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_k_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    <span class="st">"r"</span> <span class="op">=</span> <span class="va">ab_stage0_long</span><span class="op">$</span><span class="va">r</span>,</span>
<span>    <span class="st">"K"</span> <span class="op">=</span> <span class="va">ab_stage0_long</span><span class="op">$</span><span class="va">value</span>,</span>
<span>    <span class="st">"Unit"</span> <span class="op">=</span> <span class="va">ab_stage0_long</span><span class="op">$</span><span class="va">name</span>,</span>
<span>    <span class="st">"Outcome"</span> <span class="op">=</span> <span class="st">"0"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    <span class="st">"r"</span> <span class="op">=</span> <span class="va">ab_stage1_long</span><span class="op">$</span><span class="va">r</span>,</span>
<span>    <span class="st">"K"</span> <span class="op">=</span> <span class="va">ab_stage1_long</span><span class="op">$</span><span class="va">value</span>,</span>
<span>    <span class="st">"Unit"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ab_stage1_long</span><span class="op">$</span><span class="va">name</span>, <span class="st">"_1"</span><span class="op">)</span>,</span>
<span>    <span class="st">"Outcome"</span> <span class="op">=</span> <span class="st">"1"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_K_functions.html">plot_K_functions</a></span><span class="op">(</span><span class="va">data_k_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="funkycells_files/figure-html/compare_k_functions-1.png" width="700"></p>
<p>We can also consider ROC curves (Figure may not be shown due to
computational reasons).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_roc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_funkyForest.html">predict_funkyForest</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">model_fc</span><span class="op">$</span><span class="va">model</span>,</span>
<span>  data_pred <span class="op">=</span> <span class="va">pcaMeta</span><span class="op">[</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  data <span class="op">=</span> <span class="va">pcaMeta</span><span class="op">[</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/computePseudoROCCurves.html">computePseudoROCCurves</a></span><span class="op">(</span><span class="va">pcaMeta</span><span class="op">$</span><span class="va">Stage</span>, <span class="va">pred_roc</span><span class="op">$</span><span class="va">PredPerc</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>There are many uses for funkycells, but we hope this gives a taste of
the current functionality and aids in understanding of the documentation
provided.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jeremy VanderDoes.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
